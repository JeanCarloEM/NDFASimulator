!function(t,a){t.updateTbl=function(s,i,e,n,l,r,o){var d=a("#passos tr");if(!d||d.length<=0){if(!a("article")||a("article").length<=0)throw"ARTICLE NADA AINDA";a("article").append("<div><table id='passos' cellpadding='0' cellspacing='0'><tr></tr><tr></tr></table></div>"),d=a("#passos tr")}if(o>=0&&3>=o&&(a("#passos tr:last-of-type td").length<=i&&d.append("<td id='td_"+i+"'></td>"),"string"==typeof s&&s.length>0&&!a("#passos tr:first-of-type td#td_"+(i-1)).html()&&a("#passos tr:first-of-type td#td_"+(i-1)).html(s),(0===o||2===o)&&null!==l&&l>=0&&a("#passos tr td:last-of-type div.q"+l).length<=0)){var p=a("#passos tr:last-of-type td#td_"+i);p.append("<div class='"+(0===o?" epson":"")+(t.lfacalc.dts.finais.indexOf(l)>=0||r?" final":"")+" q"+l+"'><span>q"+l+"</span></div>")}},t.setSigma=function(){var t=a("section.principal div.sigma input[type='text']");if(t.val(t.val().replace(/(.)(?=.*\1)/g,"")),t.val()!==t.attr("old")){if(a("#estados").html(" "),a("section.principal div.avaliar").css("display","none"),t.val().length>1){for(var s="",i=0;i<t.val().length;i++)s+="<td>"+("@"===t.val()[i]?"&epsilon;":t.val()[i])+"</td>";a("#estados").html("<tr><td>ST</td>"+s+"</tr>"),a("section.principal div.tbl").css("display","inline-block")}t.attr("old",t.val())}},t.validadeEstados=function(t,s){s=s===!0||s===!1?s:!1,t=s?t:a(this),t.removeClass("vazio erro");var i=t.val().replace(/[\[\],\s]*/g,"");if(t.val().length<=0)return t.addClass("vazio"),!0;var e=!0;if(i.length>0){var n=new RegExp(t.attr("regex"));if(n.test(t.val())){for(var l=a("#estados tr.estados").length,r=0;r<i.length;r++)if(parseInt(i[r])>=l){e=!1;break}}else e=!1}else e=!1;return e?!0:(t.addClass("erro"),!1)},a(document).ready(function(){a("section.principal > div div.sigmago").on("click",function(){t.setSigma()}),a("section.principal div.sigma input").on("keyup",function(t){13===t.keyCode&&a(this).blur()}),a("section.principal div.sigma input").on("blur",function(a){t.setSigma()}),a("section.principal div.avaliar input").on("keyup",function(t){13===t.keyCode&&a(this).blur()}),a("section.principal div.avaliar input").on("blur",function(t){a("section.principal div.avaliar > div").trigger("click")}),a("section.principal div.tbl button").on("click",function(){var s=a("section.principal > div input[type='text']");if(s.attr("old").length>1){for(var i="",e=0;e<s.val().length;e++){var n=a.trim(a("#estados tr:first-of-type td").eq(e+1).text());n="ε"==n?"__":n,i+="<td><input name='q"+(a("#estados tr").length-1)+"_"+n+"' type='text' class='destinos' regex='^s?([0-9]|\\[s?[0-9](s?,s?[0-9])*s?])?s?$'></input></td>"}a("#estados").append("<tr class='estados q"+(a("#estados tr").length-1)+"' st='"+(a("#estados tr").length-1)+"'><td class=\"estado\" st='"+(a("#estados tr").length-1)+"'>q"+(a("#estados tr").length-1)+"</td>"+i+"</tr>"),a("#estados tr td:first-of-type").off("click"),a("#estados tr td input").off("keyup"),a("#estados tr td input").off("blur"),a("#estados tr td input").on("keyup",t.validadeEstados),a("#estados tr td input").on("blur",t.validadeEstados),a("#estados tr > td:first-of-type").on("click",function(t){a(this).toggleClass("checked")}),a("section.principal div.avaliar").css("display","block")}}),a("section.principal div.avaliar > div").on("click",function(){if(a("section.principal div.avaliar input").val().length>0){var s=a("#estados tr td input"),i=!0;if(s.length>0)for(var e=0;e<s.length;e++){var n=a(s[e]);if(!t.validadeEstados(n,!0)){i=!1;break}}else i=!1;if(i){for(var l={abto:a("section.principal div.sigma input").val().split(""),destinos:[],start:a("section.principal div.starterq input").val(),finais:[],steps:[[]]},e=0;e<l.abto.length;e++)l.abto[e]="@"===l.abto[e]?null:l.abto[e];for(var r=a("#estados tr > td.estado:first-of-type"),e=0;e<r.length;e++)a(r[e]).hasClass("checked")&&l.finais.push(parseInt(a(r[e]).attr("st")));for(var o=a("#estados tr.estados"),e=0;e<o.length;e++){for(var d=a(o[e]).attr("st"),p=[],c=0;c<l.abto.length;c++){var v=a("#estados tr td input[name='q"+d+"_"+(null===l.abto[c]?"__":l.abto[c])+"']").val();p.push(v)}l.destinos.push(p)}if(l.start>=l.destinos.length)return alert("[ERRO] o Estado Inicial selecionado ("+l.start+") é superior ao estado maior ("+(l.destinos.length-1)+")"),0;t.lfacalc||(t.lfacalc=new t.lfa),a("article").html(" "),t.lfacalc.match(l,a("section.principal div.avaliar input").val(),t.updateTbl)?a("div.resultado").html("O Autômato reconhece a string. String aceita!"):a("div.resultado").html("O Autômato NÃO reconhece a string. String rejeitada!")}else alert("O estados destinos não estão preenchidos corretamente!")}else alert("Nenhuma string a ser avaliada.")})})}(window,"object"==typeof jQuery?jQuery:Zepto);