window.predefs=[{json:{abto:["ω",".","-","_","@","ε"],destinos:[[1,"","","","",""],["1,5",2,4,3,"",""],[5,"","","","",""],[5,"","",3,"",""],[5,"","","","",""],[5,"","","",6,1],[7,"","","","",""],["7,10",8,9,"","",""],["10","","","","",""],["10","","","","",""],["10","11","","","",7],["12","","","","",""],["14","","13","","",""],["14","","","","",""],["14","","13","","",""]],start:0,finais:[14],steps:[[]]},chars:"ω.-_@ε"},{json:{abto:["Δ",".",",","ε"],destinos:[[1,"","",""],[2,"","",3],[3,"","",3],["",7,4,""],[5,"","",""],[6,"","",""],["","","",""],[8,"","",""],[9,"","",""],[3,"","",""]],start:0,finais:[6],steps:[[]]},chars:"Δ.,ε"},{json:{abto:["0","1"],destinos:[["",1],["1,2",1],["",""]],start:0,finais:[2],steps:[[]]},chars:"01"},{json:{abto:["0","1"],destinos:[[2,1],[3,0],[0,3],[1,2]],start:0,finais:[0],steps:[[]]},chars:"01"}],function(t,a){t.buildTbl=function(s,i){if("object"==typeof s){a("input[name='alfabeto']").val(i),t.setSigma();for(var e=0;e<s.destinos.length;e++){a("section.principal div.tbl button").trigger("click");for(var o=a(".tbl table tr:last-of-type td input"),n=0;n<o.length;n++)a(o[n]).val(s.destinos[e][n]);s.finais.indexOf(e)>=0&&a(".tbl table tr:last-of-type td:first-of-type").trigger("click")}}return!1},t.updateTbl=function(s,i,e,o,n,l,r){var d=a("#passos tr");if(!d||d.length<=0){if(!a("article")||a("article").length<=0)throw"ARTICLE NADA AINDA";a("article").append("<div class='estados'><table id='passos' cellpadding='0' cellspacing='0'><tr></tr><tr></tr></table></div>"),d=a("#passos tr")}if(r>=0&&3>=r&&(a("#passos tr:last-of-type td").length<=i&&d.append("<td step='"+i+"' id='td_"+i+"'"+(0===i?"class='ativo'":"")+"></td>"),"string"==typeof s&&s.length>0&&!a("#passos tr:first-of-type td#td_"+(i-1)).html()&&a("#passos tr:first-of-type td#td_"+(i-1)).html(s),(0===r||2===r)&&null!==n&&n>=0&&a("#passos tr td:last-of-type div.q"+n).length<=0)){var c=a("#passos tr:last-of-type td#td_"+i);c.append("<div st='"+n+"' class='"+(0===r?" epson":"")+(t.lfacalc.dts.finais.indexOf(n)>=0||l?" final":"")+" q"+n+"'><span>q"+n+"</span></div>")}},t.setSigma=function(){var t=a("section.principal div.sigma input[type='text']");if(t.val(t.val().replace(/(.)(?=.*\1)/g,"")),t.val()!==t.attr("old")){if(a("#estados").html(" "),a("section.principal div.avaliar").css("display","none"),a("section.principal >div.automato").css("display","none"),t.val().length>1){for(var s="",i=0;i<t.val().length;i++)s+="<td>"+("ε"===t.val()[i]?"&epsilon;":"Δ"===t.val()[i]?"[0-9]":"α"===t.val()[i]?"[a-zA-Z]":"ω"===t.val()[i]?"[a-zA-Z0-9]":t.val()[i])+"</td>";a("#estados").html("<tr><td>ST</td>"+s+"</tr>"),a("section.principal div.tbl").css("display","block")}t.attr("old",t.val())}},t.validadeEstados=function(t,s){a("section.principal >div.automato").css("display","none"),s=s===!0||s===!1?s:!1,t=s?t:a(this),t.removeClass("vazio erro");var i=t.val().replace(/[\[\],\s]*/g,"");if(t.val().length<=0)return t.addClass("vazio"),!0;var e=!0;if(i.length>0){var o=new RegExp(t.attr("regex"));if(o.test(t.val())){for(var n=a("#estados tr.estados").length,l=0;l<i.length;l++)if(parseInt(i[l])>=n){e=!1;break}}else e=!1}else e=!1;return e?!0:(t.addClass("erro"),!1)},t.addST=function(t,s,i,e,o){if(a("div.automato2 > div").length<=0&&a("div.automato2").append("<div class='estados'><table id='automato' cellpadding='0' cellspacing='0'><tr></tr><tr></tr></table></div>"),linhas=a("div.automato2 div table tr"),o=parseInt(o),o=isNaN(o)?a("div.automato2 div tr:last-of-type td").length:o,linhas.length>1&&t>=0&&o>=0){a("div.automato2 div table tr td[coluna='"+o+"']").length<=0&&linhas.append("<td class='q"+t+"' st='"+t+"' coluna='"+o+"'></td>");var n=a("div.automato2 div table tr:last-of-type td[coluna='"+o+"']");n.append("<div class='"+(e===!0?" epson":"")+(i?" final":"")+(s?" inicial":"")+" q"+t+"'><span>q"+t+"</span></div>")}},t.STUpdate=function(){},t.refreshautomato=function(s){for(var i=[],e=a(a("article table tr:last-of-type td")[s]).children("div"),o=0;o<e.length;o++)i.push(parseInt(a(e[o]).attr("st")));t.lfadrw(a("canvas")[0],JSON.parse(t.ativojson),64,i)},a(document).ready(function(){a("section.principal > div div.sigmago").on("click",function(){t.setSigma()}),a("section.principal div.sigma input").on("keyup",function(t){13===t.keyCode&&a(this).blur()}),a("section.principal div.sigma input").on("blur",function(a){t.setSigma()}),a("section.principal div.avaliar input").on("keyup",function(t){13===t.keyCode&&a(this).blur()}),a("section.principal div.avaliar input").on("blur",function(t){a("section.principal div.avaliar > div").trigger("click")}),a("section.principal div.tbl button").on("click",function(){var s=a("section.principal div.sigma input[type='text']");if(a("section.principal >div.automato").css("display","none"),(""+s.attr("old")).length>1){for(var i="",e=0;e<s.val().length;e++){var o=a.trim(a("#estados tr:first-of-type td").eq(e+1).text());o="ε"===o?"__":"[0-9]"===o?"___":"[a-zA-Z]"===o?"____":"[a-zA-Z0-9]"===o?"_____":o,i+="<td><input name='q"+(a("#estados tr").length-1)+"_"+o+"' type='tel' class='destinos' regex='^(s*[0-9]+(s*[,.-]s?[0-9]+)*s*)?$'></input></td>"}a("#estados").append("<tr class='estados q"+(a("#estados tr").length-1)+"' st='"+(a("#estados tr").length-1)+"'><td class=\"estado\" st='"+(a("#estados tr").length-1)+"'>q"+(a("#estados tr").length-1)+"</td>"+i+"</tr>"),a("#estados tr td:first-of-type").off("click"),a("#estados tr td input").off("keyup"),a("#estados tr td input").off("blur"),a("#estados tr td input").on("keyup",t.validadeEstados),a("#estados tr td input").on("blur",t.validadeEstados),a("#estados tr > td:first-of-type").on("click",function(t){a(this).toggleClass("checked")}),a("section.principal div.avaliar").css("display","block")}}),a("div.sigma select").on("change",function(){if(a(this).attr("selecionado")!==a(this).val()){a(this).attr("selecionado",a(this).val());var s=chrs="";switch(a(this).val()){case"email":s=t.predefs[0].json,chrs=t.predefs[0].chars;break;case"moeda":s=t.predefs[1].json,chrs=t.predefs[1].chars;break;case"bit":s=t.predefs[2].json,chrs=t.predefs[2].chars;break;case"bitpar":s=t.predefs[3].json,chrs=t.predefs[3].chars}t.buildTbl(s,chrs)}}),a("div.sigma table td:first-of-type").on("click",function(){console.log(a(this).text()),a("div.sigma input").val().indexOf(a(this).text())<0&&(a("div.sigma input").val(a("div.sigma input").val()+a(this).text()),a("div.sigma input").focus(),t.setSigma())}),a("div.automato div.passo button.next").on("click",function(){if(t.ativojson){var s=parseInt(a("article table tr:last-of-type td.ativo").attr("step"));s>=0&&a("article table tr:last-of-type td").length>s+1&&(s++,a("article table tr td").removeClass("ativo"),a(a("article table tr:last-of-type td")[s]).addClass("ativo"),a(a("article table tr:first-of-type td")[s]).addClass("ativo"),t.refreshautomato(s))}}),a("div.automato div.passo button.prev").on("click",function(){if(t.ativojson){var s=parseInt(a("article table tr:last-of-type td.ativo").attr("step"));s>0&&(s--,a("article table tr td").removeClass("ativo"),a(a("article table tr:last-of-type td")[s]).addClass("ativo"),a(a("article table tr:first-of-type td")[s]).addClass("ativo"),t.refreshautomato(s))}}),a("section.principal div.avaliar > div").on("click",function(){if(a("section.principal div.avaliar input").val().length>0){a("section.principal div.avaliar input").removeClass("erro");var s=a("#estados tr td input"),i=!0;if(s.length>0)for(var e=0;e<s.length;e++){var o=a(s[e]);if(!t.validadeEstados(o,!0)){i=!1;break}}else i=!1;if(i){for(var n={abto:a("section.principal div.sigma input").val().split(""),destinos:[],start:0,finais:[],steps:[[]]},e=0;e<n.abto.length;e++)n.abto[e]=n.abto[e];for(var l=a("#estados tr > td.estado:first-of-type"),e=0;e<l.length;e++)a(l[e]).hasClass("checked")&&n.finais.push(parseInt(a(l[e]).attr("st")));for(var r=a("#estados tr.estados"),e=0;e<r.length;e++){for(var d=a(r[e]).attr("st"),c=[],p=0;p<n.abto.length;p++){var v=a("#estados tr td input[name='q"+d+"_"+("ε"===n.abto[p]?"__":"Δ"===n.abto[p]?"___":"α"===n.abto[p]?"____":"ω"===n.abto[p]?"_____":n.abto[p])+"']").val();/^[0-9]$/.test(v)?c.push(parseInt(v)):c.push(v)}n.destinos.push(c)}if(n.start>=n.destinos.length)return alert("[ERRO] o Estado Inicial selecionado ("+n.start+") é superior ao estado maior ("+(n.destinos.length-1)+")"),0;t.lfacalc||(t.lfacalc=new t.lfa),a("article").html(" "),a("div.automato2").html(" "),t.regex=new t.lfaRegex,n=regex.make(n,null,null),t.ativojson=JSON.stringify(n),a("section.principal >div.automato").css("display","block"),t.lfadrw(a("canvas")[0],n,64),t.lfacalc.match(n,a("section.principal div.avaliar input").val(),t.updateTbl)?a("div.resultado").html("O Autômato ("+(t.lfacalc.dts.nfa?"AFND":"AFD")+") reconhece a string. String aceita!"):a("div.resultado").html("O Autômato ("+(t.lfacalc.dts.nfa?"AFND":"AFD")+") NÃO reconhece a string. String rejeitada!")}else alert("O estados destinos não estão preenchidos corretamente!")}else a("section.principal div.avaliar input").addClass("erro")})})}(window,"object"==typeof jQuery?jQuery:Zepto);